<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>假文件入库管理面板</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="topbar">假文件入库管理面板</div>
  <div class="container">
    <div class="left">
      <div class="panel card">
        <div class="notice-row">
          <h3 style="margin:0">目录浏览与选择</h3>
          <div>
            <button id="refreshRoots" class="tiny">刷新挂载点</button>
          </div>
        </div>

        <div class="card-note fixed" id="mainNote">在下方选择挂载点（左侧选择源，右侧选择目标），导航进入子目录，选择任意深度的目录后点击“加入已选”。<br><small style="color:var(--note-text)">可多选；选择后会出现在“已选择（源）”。目标可重复添加（例如将多个源按索引配对到相同目标）。</small></div>

        <div class="quick-row">
          <div class="quick-col">
            <label>源目录选择</label>
            <div class="browser">
              <div class="browser-row">
                <select id="srcRootSelect" class="root-select"></select>
                <button id="srcUpBtn" class="tiny">上层</button>
              </div>
              <div id="srcBreadcrumb" class="breadcrumb"></div>
              <div id="srcEntries" class="entries"></div>
              <div class="browser actions">
                <div class="btn-row-small">
                  <button id="chooseSrcBtn" class="small src-add">加入已选（源）</button>
                </div>
              </div>
            </div>
          </div>

          <div class="quick-col">
            <label>目标目录选择</label>
            <div class="browser">
              <div class="browser-row">
                <select id="dstRootSelect" class="root-select"></select>
                <button id="dstUpBtn" class="tiny">上层</button>
              </div>
              <div id="dstBreadcrumb" class="breadcrumb"></div>
              <div id="dstEntries" class="entries"></div>
              <div class="browser actions">
                <div class="btn-row-small">
                  <button id="chooseDstBtn" class="small dst-add">加入已选（目标）</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="hint small">注：如果某挂载点/目录没有在下拉中出现，请在 docker-compose 中把宿主机目录以 volumes 映射到容器并重启容器。</div>
      </div>

      <div class="panel card">
        <h3>已选择（源 / 目标）</h3>
        <div class="selected-wrap">
          <div class="sel-col">
            <h4>来源 (Sources)</h4>
            <div id="srcList" class="pills"></div>
          </div>
          <div class="sel-col">
            <h4>目标 (Destinations)</h4>
            <div id="dstList" class="pills"></div>
          </div>
        </div>

        <div class="controls">
          <div class="btn-row">
            <label class="mode-label"><input type="radio" name="mode" value="incremental" checked /> 增量备份</label>
            <label class="mode-label"><input type="radio" name="mode" value="full" /> 全量备份</label>
          </div>
          <div class="btn-row" style="margin-top:10px;">
            <button id="addPairs" class="primary">添加任务</button>
            <button id="clearSelected" class="danger">清空已选</button>
          </div>
          <div class="card-note small" style="margin-top:12px;">说明：按索引配对（第1源→第1目标，第2源→第2目标）。备份模式：增量（仅处理新增的，使用 backup_log.txt）或 全量（忽略 backup_log.txt，全部重新生成并覆盖占位文件）。</div>
        </div>
      </div>

      <div class="panel card">
        <h3>任务队列</h3>
        <ul id="queue"></ul>
        <div class="card-note small">已提交但未执行的任务显示在这里。</div>
      </div>
    </div>

    <div class="right">
      <div class="panel card">
        <h3>运行日志</h3>
        <pre id="log" class="log"></pre>
        <div class="card-note small">日志由服务端实时推送，记录成功、警告与错误。</div>
      </div>
    </div>
  </div>

  <script src="/static/js/app.js"></script>
</body>
</html>
